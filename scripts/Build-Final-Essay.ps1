$m2e_path = "C:\Users\hellw\OneDrive - Colorado Community College System\COM120\Module-2\M2E_Mars-Venus-Earth"

Write-Host 'Cleaning LaTeX Project'
Remove-Item "$m2e_path\*_temp.tex"
Remove-Item "$m2e_path\*.aux"
Remove-Item "$m2e_path\*.4ct"
Remove-Item "$m2e_path\*.4tc"
Remove-Item "$m2e_path\*.dvi"
Remove-Item "$m2e_path\*.idv"
Remove-Item "$m2e_path\*.lg"
Remove-Item "$m2e_path\*.out.ps"
Remove-Item "$m2e_path\*.tmp"
Remove-Item "$m2e_path\*.xref"
Remove-Item "$m2e_path\*.bbl"
Remove-Item "$m2e_path\*.bcf"
Remove-Item "$m2e_path\*.blg"
Remove-Item "$m2e_path\*.idx"
Remove-Item "$m2e_path\*.ind"
Remove-Item "$m2e_path\*.lof"
Remove-Item "$m2e_path\*.lot"
Remove-Item "$m2e_path\*.out"
Remove-Item "$m2e_path\*.toc"
Remove-Item "$m2e_path\*.acn"
Remove-Item "$m2e_path\*.acr"
Remove-Item "$m2e_path\*.alg"
Remove-Item "$m2e_path\*.glg"
Remove-Item "$m2e_path\*.glo"
Remove-Item "$m2e_path\*.gls"
Remove-Item "$m2e_path\*.ist"
Remove-Item "$m2e_path\*.fls"
Remove-Item "$m2e_path\*.log"
Remove-Item "$m2e_path\*.fdb_latexmk"
Remove-Item "$m2e_path\*.synctex.gz"
Remove-Item "$m2e_path\*.lol"
Remove-Item "$m2e_path\*.run.xml"
Remove-Item "$m2e_path\*.pdf"

Write-Host 'Building LaTeX Project'
& 'C:\Program Files\MiKTeX\miktex\bin\x64\latexmk.exe' '-pdf' '-pdflatex="pdflatex -interaction=nonstopmode"'
& 'C:\Program Files\MiKTeX\miktex\bin\x64\biber.exe' 'main'
& 'C:\Program Files\MiKTeX\miktex\bin\x64\latexmk.exe' '-pdf' '-pdflatex="pdflatex -interaction=nonstopmode"'
& 'C:\Program Files\MiKTeX\miktex\bin\x64\latexmk.exe' '-pdf' '-pdflatex="pdflatex -interaction=nonstopmode"'

Write-Host 'Moving File to out/ASHELLWIG_M1E_Picture-Perfect.pdf'
Move-Item -Path "$m2e_path\main.pdf" -Destination "$m2e_path\out\ASHELLWIG_M2E_Mars-Venus-Earth.pdf"

Write-Host 'Cleaning Project Directory'
& 'C:\Program Files\MiKTeX\miktex\bin\x64\latexmk.exe' '-CA'
Remove-Item "$m2e_path\*_temp.tex"
Remove-Item "$m2e_path\*.aux"
Remove-Item "$m2e_path\*.4ct"
Remove-Item "$m2e_path\*.4tc"
Remove-Item "$m2e_path\*.dvi"
Remove-Item "$m2e_path\*.idv"
Remove-Item "$m2e_path\*.lg"
Remove-Item "$m2e_path\*.out.ps"
Remove-Item "$m2e_path\*.tmp"
Remove-Item "$m2e_path\*.xref"
Remove-Item "$m2e_path\*.bbl"
Remove-Item "$m2e_path\*.bcf"
Remove-Item "$m2e_path\*.blg"
Remove-Item "$m2e_path\*.idx"
Remove-Item "$m2e_path\*.ind"
Remove-Item "$m2e_path\*.lof"
Remove-Item "$m2e_path\*.lot"
Remove-Item "$m2e_path\*.out"
Remove-Item "$m2e_path\*.toc"
Remove-Item "$m2e_path\*.acn"
Remove-Item "$m2e_path\*.acr"
Remove-Item "$m2e_path\*.alg"
Remove-Item "$m2e_path\*.glg"
Remove-Item "$m2e_path\*.glo"
Remove-Item "$m2e_path\*.gls"
Remove-Item "$m2e_path\*.ist"
Remove-Item "$m2e_path\*.fls"
Remove-Item "$m2e_path\*.log"
Remove-Item "$m2e_path\*.fdb_latexmk"
Remove-Item "$m2e_path\*.synctex.gz"
Remove-Item "$m2e_path\*.lol"
Remove-Item "$m2e_path\*.run.xml"
